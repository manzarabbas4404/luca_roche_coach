{% extends 'base.html' %}
{% load static %}

{% block content %}

<style>
  /* Style the form */
  #regForm {
    /* background-color: #ffffff;
    margin: 70px auto; */
    padding: 40px;
    width: 70%;
    min-width: 300px;

  }

  @media screen and (max-width:775px) {
    .col-form-label {
      background-color: black;
      color: white;
      font-size: 15px !important;
      border-radius: 1rem;
      font-weight: 600 !important;
    }

    #regForm {
      padding: 0px;
      width: 85%;
      /* min-width: 100%; */
      padding-top: 7% !important;
    }

    .register-heading {
      color: #000000;
      font-size: 45px !important;
    }

    .under-heading {
      font-size: 25px !important;
    }

    .under-heading2 {
      font-size: 30px !important;
    }

    .add-p {
      font-size: 30px !important;
    }

    .step3-head {
      font-size: 30px !important;
    }

    .price-cut {
      font-size: 55px !important;
    }

    .green-head {
      font-size: 60px !important;
    }

    .vl {
      height: 225px !important;
    }
  }

  @media screen and (max-width:525px) {
    #regForm {
      padding: 0px;
      width: 100%;
      min-width: 100%;
      padding-top: 7% !important;
    }

    .register-heading {
      color: #000000;
      font-size: 25px !important;
      font-weight: 900;
      font-style: italic;
    }

    .under-heading {
      font-size: 15px !important;
    }

    .under-heading2 {
      font-size: 18px !important;
    }

    .set-btn {
      padding: 0;
    }

    .email-field {
      padding: 25px !important;
      background-color: #f4f4f4;
      margin: 0px !important;
      margin-top: 25px !important;
      margin-bottom: 25px !important;
    }

    .add-p {
      font-size: 15px !important;
    }

    .step3-head {
      font-size: 25px !important;
    }

    .price-cut {
      font-size: 25px !important;
    }

    .fa-caret-down {
      font-size: 50px !important;
    }

    .green-head {
      font-size: 30px !important;
    }

    .vl {
      height: 100px !important;
    }

    .stepping {
      margin-top: 5% !important;
    }
  }

  /* Style the input fields */
  input {
    padding: 10px;
    width: 100%;
    font-size: 17px;
    font-family: Raleway;
    border: 1px solid #aaaaaa;
  }

  /* Mark input boxes that gets an error on validation: */
  input.invalid {
    background-color: #ffdddd;
  }

  /* Hide all steps by default: */
  .tab {
    display: none;
  }

  /* Make circles that indicate the steps of the form: */
  .step {
    height: 15px;
    width: 15px;
    margin: 0 2px;
    background-color: #bbbbbb;
    border: none;
    border-radius: 50%;
    display: inline-block;
    opacity: 0.5;
  }

  /* Mark the active step: */
  .step.active {
    opacity: 1;
  }

  /* Mark the steps that are finished and valid: */
  .step.finish {
    background-color: #04AA6D;
  }

  .overall {
    margin: 0 auto;
    padding: 10px;
    border: 0.1px solid lightgrey;
    border-radius: 44px;
    box-shadow: 5px 6px 7px 5px #bebebe;
  }

  .register-heading {
    color: #000000;
    font-size: 59px;
    font-weight: 900;
    font-style: italic;
  }

  .under-heading {
    color: #000000;
    font-size: 43px;
    font-weight: 500;
    font-style: italic;
    line-height: 1.2em;
    letter-spacing: 0.9px;
  }

  .under-heading2 {
    font-size: 50px;
    font-weight: 700;
    text-decoration: underline !important;
  }


  .step3 {
    border-radius: 20px 20px 20px 20px;
    border-style: solid;
    border-width: 1px 1px 1px 1px;
    border-color: #CFCCCC;
    box-shadow: 10px 0px 10px 2px rgb(147 147 147 / 50%);
    margin: 0 auto;
  }

  .step3-head {
    color: #000000;
    font-family: "Candy Beans", Sans-serif;
    font-size: 40px;
    font-weight: 900;
    font-style: italic;
    line-height: 1.1em;
  }

  .vl {
    height: 300px;
    background-color: grey;
    width: 3px;
  }

  .price-cut {
    font-family: "Candy Beans", Sans-serif;
    font-size: 65px;
    font-weight: 900;
    font-style: italic;
    text-decoration: line-through red;
    line-height: 1.1em;
  }

  .green-head {
    color: #1C960B;
    font-family: "Public Secret", Sans-serif;
    font-size: 110px;
    font-weight: 900;
    font-style: italic;
    line-height: 1.1em;
  }

  .add-p {
    color: #20E11A;
    font-size: 40px;
    font-weight: 900;
    font-style: italic;
  }

  .email-field {
    padding: 50px;
    background-color: #f4f4f4;
    margin: 100px;
    margin-top: 50px;
    margin-bottom: 30px;
  }

  .col-form-label {
    background-color: black;
    color: white;
    font-size: 20px;
    border-radius: 1rem;
    font-weight: 700;
  }
</style>

<div class="container">
  <input class="setValue" type="hidden" value="dfs">
  <div class="row overall mt-5">
    <div class="col-12 col-md-12 col-lg-12" style="margin: 0 auto;">


      <!-- <form id="" action="" class="text-center" style="margin: 0 auto;"> -->





        <div class="tab text-center">
          <h2 class="register-heading">ETAPE 1 SUR 3</h2>
          <h2 class="under-heading pt-4">Complète la configuration de ton programme</h2>
          <h2 class="under-heading pt-4">Le programme est une expérience personnalisée selon tes goûts</h2>
          <h2 class="under-heading pt-4">commence pas la création de ton compte</h2>
        </div>

        <div class="tab">
          <h2 class="register-heading">ETAPE 1 SUR 3</h2>
          <h2 class="under-heading pt-3">Créer ton mot de passe pour démarrer</h2>
          <h2 class="under-heading pt-3">Plus que quelques étapes..</h2>

          <form action="/subscription/" method="post" id="orderform">
            {% csrf_token %}
          <div class="mt-5 mb-5">
            <div class="form-group row">
              <label for="inputPassword" class="col-md-4 col-lg-4 col-9 col-form-label"
                style="margin: 0 auto;">Email</label>
              <div class="col-md-8 col-lg-8 col-11" style="margin: 0 auto;">
                <input type="email" name="email" class="form-control" id="inputPassword" style="border: 2px solid;">
              </div>
            </div>
            <div class="form-group row">
              <label for="inputPassword" class="col-md-4 col-lg-4 col-9 col-form-label" style="margin: 0 auto;">mot de
                passe </label>
              <div class="col-md-8 col-lg-8 col-11" style="margin: 0 auto;">
                <input type="password" name="password" class="form-control" id="inputPassword" style="border: 2px solid;">
              </div>
              <!-- <button type="submit" class="btn btn-primary">Submit</button> -->
            </div>
          </div>
        </form>
        </div>

        <div class="tab text-center">
          <h2 class="register-heading">ETAPE 2 SUR 3</h2>
          <h2 class="under-heading pt-4">Choisis ton programe</h2>
          <h2 class="under-heading pt-4">Accés illimité sur tous tes appareils</h2>
          <h2 class="under-heading pt-4">Guide et soutiens pour ton objectif</h2>
          <h2 class="under-heading pt-4">Toutes les dernières connaissances en science du sport et de la nutrition</h2>
        </div>


        <div class="tab text-center">
          <h2 class="register-heading">ETAPE 2 SUR 3</h2>
          <!--here-->
          <p class="add-p">Clique sur ton programme et poursuis ton inscription</p>
          <!-- 
          <div class="row">
            <div class="col-12 col-md-5 col-lg-5 step3">
              <h2 class="step3-head" style="padding: 15%;">Classic challenge <br> 3 MOIS</h2>
            </div>
            <div class="col-12 col-md-5 col-lg-5 step3 stepping">
              <h2 class="step3-head" style="padding: 15%;">Perform challenge <br>3 MOIS<br></h2>
            </div>
          </div> -->

          <div class="row mt-5">
            <div class="col-lg-4 col-md-4 my-3 my-md-0 my-lg-0">
              <div class="card" style="border-top: none;">
                <input type="hidden" class="carr" name="carr" value="150" />
                <div style="border-radius: 5px 5px 0 0;
                background-color: grey;
                padding: 0 !important;">
                  <h5 class="py-lg-2 text-white pt-lg-3 py-md-2 pt-md-3 p-2 pt-3"><strong>1 mois</strong></h5>
                </div>


                <h4 style="color: #8cce8c;" class="py-lg-4 pb-lg-3 py-md-4 pb-md-3 py-3 pb-2"><strong>
                    150€ Prix</strong></h4>

                <h6 class="px-lg-4 mx-lg-5 px-md-2 mx-md-2 px-3">150€ / mois</h6>

                <h6 class="px-lg-5 px-md-1 px-2 pt-lg-2"><strong>Paiement une fois </strong></h6>

                <h5 class="py-lg-2 py-md-1 py-1"><strong style="font-weight: 800;">Renouvelable </strong>
                </h5>

                <form>
                  <div style="color: #8cce8c;">
                    <p class="px-lg-3 px-md-2 px-2">Sssssssatisfait ou remboursé </p>
                    <span>
                      <h5 class="form-switch">
                        <input class="form-check-input custom-control-input" style="margin-right: 2%; margin-top: 0.5%;"
                          type="checkbox" name="roku" value="Yes" checked>
                        <span class="fw-bold">Homme / Femme </span>
                      </h5>
                    </span>
                    <p>Accompagnement nutrition</p>
                    <p>Accompagnement musculation</p>
                    <p>Suivi quotidien </p>
                  </div>

                  <input type="hidden" value="{{product.id}}" name="product">

                  <div class="py-lg-3 py-3">
                    <button type="button"
                      class="btn btn-secondary rounded-pill bg-color px-lg-5 px-md-4 my-md-1 maintenant">Achetez
                      maintenant
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-right mx-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                          d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" />
                      </svg>
                    </button>
                  </div>
                </form>
              </div>
            </div>

            <div class="col-lg-4 col-md-4 my-3 my-md-0 my-lg-0">
              <div class="card" style="border-top: none;">
                <input type="hidden" class="carr" name="carr" value="390" />
                <div style="border-radius: 5px 5px 0 0;
                background-color: grey;
                padding: 0 !important;">
                  <h5 class="py-lg-2 text-white pt-lg-3 py-md-2 pt-md-3 p-2 pt-3"><strong>3 mois</strong></h5>
                </div>

                <h4 style="color: #8cce8c;" class="py-lg-4 pb-lg-3 py-md-4 pb-md-3 py-3 pb-2"><strong>
                    390€ Prix</strong></h4>

                <h6 class="px-lg-4 mx-lg-5 px-md-2 mx-md-2 px-3">130€ / mois </h6>

                <h6 class="px-lg-5 px-md-1 px-2 pt-lg-2"><strong>Paiement 1 ou 3 fois </strong></h6>

                <h5 class="py-lg-2 py-md-1 py-1"><strong style="font-weight: 800;">Renouvelable </strong>
                </h5>

                <form action="#">
                  {% csrf_token %}
                  <div style="color: #8cce8c;">
                    <p class="px-lg-3 px-md-2 px-2">Satisfait ou remboursé </p>
                    <span>
                      <h5 class="form-switch">
                        <input class="form-check-input custom-control-input" style="margin-right: 2%; margin-top: 0.5%;"
                          type="checkbox" name="roku" value="Yes" checked>
                        <span class="fw-bold">Homme / Femme </span>
                      </h5>
                    </span>
                    <p>Accompagnement nutrition</p>
                    <p>Accompagnement musculation</p>
                    <p>Suivi quotidien </p>
                  </div>

                  <input type="hidden" value="{{product.id}}" name="product">

                  <div class="py-lg-3 py-3">
                    <button type="button"
                      class="btn btn-secondary rounded-pill bg-color px-lg-5 px-md-4 my-md-1 maintenant">Achetez
                      maintenant
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-right mx-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                          d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" />
                      </svg>
                    </button>
                  </div>
                </form>
              </div>
            </div>

            <div class="col-lg-4 col-md-4 my-3 my-md-0 my-lg-0">
              <div class="card" style="border-top: none;">
                <input type="hidden" class="carr" name="carr" value="600" />
                <div style="border-radius: 5px 5px 0 0;
                background-color: grey;
                padding: 0 !important;">
                  <h5 class="py-lg-2 text-white pt-lg-3 py-md-2 pt-md-3 p-2 pt-3"><strong>6 mois</strong></h5>
                </div>

                <h4 style="color: #8cce8c;" class="py-lg-4 pb-lg-3 py-md-4 pb-md-3 py-3 pb-2"><strong>
                    600€ Prix</strong></h4>

                <h6 class="px-lg-4 mx-lg-5 px-md-2 mx-md-2 px-3">100€ / mois </h6>

                <h6 class="px-lg-5 px-md-1 px-2 pt-lg-2"><strong>Paiement 1 ou 6 fois </strong></h6>

                <h5 class="py-lg-2 py-md-1 py-1"><strong style="font-weight: 800;">Renouvelable </strong>
                </h5>

                <form action="#">
                  {% csrf_token %}
                  <div style="color: #8cce8c;">
                    <p class="px-lg-3 px-md-2 px-2">Satisfait ou remboursé </p>
                    <span>
                      <h5 class="form-switch">
                        <input class="form-check-input custom-control-input" style="margin-right: 2%; margin-top: 0.5%;"
                          type="checkbox" name="roku" value="Yes" checked>
                        <span class="fw-bold">Homme / Femme </span>
                      </h5>
                    </span>
                    <p>Accompagnement nutrition</p>
                    <p>Accompagnement musculation</p>
                    <p>Suivi quotidien </p>
                  </div>

                  <input type="hidden" value="{{product.id}}" name="product">

                  <div class="py-lg-3 py-3">
                    <button type="button"
                      class="btn btn-secondary rounded-pill bg-color px-lg-5 px-md-4 my-md-1 maintenant">Achetez
                      maintenant
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-right mx-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                          d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" />
                      </svg>
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!--to here-->

        </div>



        <div class="tab">
          <div class="row text-center">


          </div>
        </div>
        <div class="tab">
          <h2 class="register-heading">ETAPE 3 SUR 3</h2>
          <h2 class="under-heading pt-4">Ton programme commence</h2>
          <h2 class="under-heading pt-3 under-heading2">48H après le paiement</h2>
          <h2 class="under-heading pt-4 ">(paiement sécurisé)</h2>
          <h2 class="under-heading pt-4 box mt-5 mb-3">payment <br> method <br> .</h2>
          <div style="margin: 0 auto;" class="col-8 col-md-6 col-lg-6 text-center mt-4">

            <span>
              <button type="submit" class="btn btn-primary btn-lg btn-block mt-2 set-btn"
                style="background-color: black; border-radius: 2rem;">Soumettre</button>
            </span>

          </div>
        </div>
        <div style="margin: 0 auto;" class="col-8 col-md-6 col-lg-6 text-center mt-4">

          <span>
            <button type="button" id="nextBtn" onclick="nextPrev(1)"
              class="btn btn-primary btn-lg btn-block mt-2 set-btn"
              style="background-color: black;border-radius: 2rem">Suivant</button>
          </span>

        </div>


        <!-- Circles which indicates the steps of the form: -->
        <div style="text-align:center;margin-top:15px;">
          <span class="step"></span>
          <span class="step"></span>
          <span class="step"></span>
          <span class="step"></span>

        </div>

      <!-- </form> -->

    </div>
  </div>
</div>



<script>
  var currentTab = 0; // Current tab is set to be the first tab (0)
  showTab(currentTab); // Display the current tab

  function showTab(n) {
    // This function will display the specified tab of the form ...
    var x = document.getElementsByClassName("tab");
    x[n].style.display = "block";
    // ... and fix the Previous/Next buttons:
    // if (n == 0) {
    //   document.getElementById("prevBtn").style.display = "none";
    // } else {
    //   document.getElementById("prevBtn").style.display = "inline";
    // }
    if (n == (x.length - 1)) {
      document.getElementById("nextBtn").style.display = "none";
    } else {
      document.getElementById("nextBtn").innerHTML = "Suivant";
    }
    // ... and run a function that displays the correct step indicator:
    fixStepIndicator(n)
  }

  function nextPrev(n) {
    // This function will figure out which tab to display
    var x = document.getElementsByClassName("tab");
    // Exit the function if any field in the current tab is invalid:
    if (n == 1 && !validateForm()) return false;
    // Hide the current tab:
    x[currentTab].style.display = "none";
    // Increase or decrease the current tab by 1:
    currentTab = currentTab + n;
    // if you have reached the end of the form... :
    if (currentTab >= x.length) {
      //...the form gets submitted:
      // document.getElementById("regForm").submit();
      return false;
    }
    // Otherwise, display the correct tab:
    showTab(currentTab);
  }

  function validateForm() {
    // This function deals with validation of the form fields
    var x, y, i, valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");
    // A loop that checks every input field in the current tab:
    for (i = 0; i < y.length; i++) {
      // If a field is empty...
      if (y[i].value == "") {
        // add an "invalid" class to the field:
        y[i].className += " invalid";
        // and set the current valid status to false:
        valid = false;
      }
    }
    // If the valid status is true, mark the step as finished and valid:
    if (valid) {
      document.getElementsByClassName("step")[currentTab].className += " finish";
    }
    return valid; // return the valid status
  }

  function fixStepIndicator(n) {
    // This function removes the "active" class of all steps...
    var i, x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
      x[i].className = x[i].className.replace(" active", "");
    }
    //... and adds the "active" class to the current step:
    x[n].className += " active";
  }
</script>



<script type="text/javascript">

  $('.maintenant').click(function () {
    var price = $(this).closest("div.card").find("input[name='carr']").val();
    $('.setValue').val(price);
    $('#gotoPayment').modal('show');
  });


</script>

<div class="modal" id="gotoPayment" aria-labelledby="gotoPayment" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <!-- <h5 class="modal-title" id="exampleModalToggleLabel2">Payment Method</h5> -->
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>

      </div>

      <div class="modal-body">
        <div id="smart-button-container">
          <div style="text-align: center;">
            <div id="paypal-button-container">
              <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
                crossorigin="anonymous"></script>

              <script
                src="https://www.paypal.com/sdk/js?client-id=AWOsCt84k13qZI7gEgFrMn3y2bHpsLMGLJE1pJLGm1XCLUCVEbNfMRF7AP7SrZjbHlL7-m6_gdmnGUXu&currency=GBP"
                data-sdk-integration-source="button-factory"></script>
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
              <script>
                function initPayPalButton() {
                  paypal.Buttons({
                    style: {
                      shape: 'pill',
                      color: 'gold',
                      layout: 'vertical',
                      label: 'paypal',
                    },
                    createOrder: function (data, actions) {
                      document.getElementById("orderform").submit()
                      return actions.order.create({
                        purchase_units: [{ "amount": { "currency_code": "GBP", "value": $('.setValue').val() } }]
                      });
                    },
                    onApprove: function (data, actions) {
                      return actions.order.capture().then(function (orderData) {

                        // Full available details
                        console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                        console.log("status", orderData.status)
                        alert('Thank you for your payment!')
                      });
                    },
                    onError: function (err) {
                      console.log(err);
                    }
                  }).render('#paypal-button-container');
                }
                initPayPalButton();
              </script>

            </div>
          </div>
        </div>
      </div>


    </div>
  </div>
</div>


{% endblock %}